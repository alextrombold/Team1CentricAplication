@*@model IEnumerable<Team1CentricAplication.Models.Profiles>*@
@model PagedList.IPagedList<Team1CentricAplication.Models.Profiles>
@using PagedList.Mvc;
@using Microsoft.AspNet.Identity;
@using Team1CentricAplication.Models;
@using Team1CentricAplication.DAL;
@*ViewBag.search = String.IsNullOrEmpty(searchString) ? "" : searchString;*@
@Html.PagedListPager(Model, page => Url.Action("Index", new { page, searchString = ViewBag.search }))

@{
    ViewBag.Title = "List of Profiles";
}

<h2>List of Profiles</h2>
<p>
    @Html.ActionLink("Create A New Profile", "Create")
</p>
<table class="table table-striped table-condensed ">
    <tr>
        <th>
            First Name
        </th>
        <th>
            Last Name
        </th>
        <th>
            Phone
        </th>
        <th>
            Email
        </th>
        <th>
            City
        </th>
        <th>
            Zip
        </th>
        <th></th>
    </tr>


    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.firstName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.lastName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.phone)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.email)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.city)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.zip)
            </td>
            <td>
                @*{
                                    Team1Context db = new Team1Context();
                                    Guid profilesId;
                                    Guid.TryParse(User.Identity.GetUserId(), out profilesId);
                                    Profiles loggedInUser = db.Profiles.Find(profilesId);
                                    if (loggedInUser != null)
                                    {
                                        bool isAdmin = loggedInUser.role == Profiles.roles.admin;
                                        if (isAdmin)
                                        {
                                            <div class="form-group">
                                                @Html.LabelFor(model => model.role, htmlAttributes: new { @class = "control-label col-md-2" })
                                                <div class="col-md-10">
                                                    @Html.EnumDropDownListFor(model => model.role, htmlAttributes: new { @class = "form-control" })
                                                    @Html.ValidationMessageFor(model => model.role, "", new { @class = "text-danger" })

                                    </div>
                                </div>
                            }
                            else
                            {
                                @Html.HiddenFor(model => model.role, new { Value = @Model.role })
                            }
                        }
                    }*@
                @{
                    <a href="~/values/create/@item.profilesID"> Recognize</a>
                }

                @Html.ActionLink("Details", "Details", new { id = item.profilesID })
                @{
                    Team1Context db = new Team1Context();
                    Guid profilesId;
                    Guid.TryParse(User.Identity.GetUserId(), out profilesId);
                    Profiles loggedInUser = db.Profiles.Find(profilesId);
                    if (loggedInUser != null)
                    {
                        bool isAdmin = loggedInUser.role == Profiles.roles.admin;
                        if (isAdmin)
                        {
                            <a href="~/profiles/delete/@item.profilesID"> | Delete</a>
                        }
                    }
                }
            </td>
        </tr>

        <tr>
            <td>
                &nbsp;
            </td>
            <td colspan="5">
                <ul class="bg-info">
                    @{
                        foreach (Team1CentricAplication.Models.Values inv in item.Values)
                        {
                            <li class="text-primary">@inv.nominatedValues</li>
                        }
                    }
                </ul>
            </td>
        </tr>
    }

</table>
<br />
Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount

@Html.PagedListPager(Model, page => Url.Action("Index", new { page }))
